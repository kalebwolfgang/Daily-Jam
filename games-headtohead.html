<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Jam — Head to Head</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0e0c0f; --surface: #161418; --surface2: #1e1b21; --border: #272330;
    --amber: #9b6dff; --amber-glow: rgba(155,109,255,0.12);
    --text: #e8e0d0; --text-dim: #7a7060; --text-muted: #3a3530;
    --green: #5dba7f; --red: #e85d4a; --blue: #5d8fe8;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: #0a0810; color: var(--text); font-family: 'Space Mono', monospace; min-height: 100vh; overflow-x: hidden; }
  body::before { content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 0;
    background:
      radial-gradient(ellipse 90% 70% at 5%  0%,   rgba(155,109,255,0.38) 0%, transparent 65%),
      radial-gradient(ellipse 70% 60% at 95% 100%,  rgba(93,143,232,0.28)  0%, transparent 60%),
      radial-gradient(ellipse 55% 45% at 88% 5%,    rgba(232,93,143,0.18)  0%, transparent 55%),
      radial-gradient(ellipse 50% 40% at 3%  95%,   rgba(93,186,127,0.18)  0%, transparent 55%); }
  body::after { content: ''; position: fixed; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E"); pointer-events: none; z-index: 9999; opacity: 0.4; }

  .site-nav { position: sticky; top: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between; padding: 0 40px; height: 56px; background: rgba(14,12,15,0.95); border-bottom: 1px solid var(--border); backdrop-filter: blur(8px); }
  .site-logo { font-family: 'Space Mono', monospace; font-size: 16px; font-weight: 700; color: var(--text); text-decoration: none; letter-spacing: 1px; }
  .site-logo span { color: var(--amber); font-style: italic; }
  .nav-links { display: flex; gap: 4px; align-items: center; }
  .nav-link { font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-dim); text-decoration: none; padding: 8px 14px; transition: color 0.15s; }
  .nav-link:hover { color: var(--text); }
  .nav-link.active { color: var(--amber); }
  .back-link { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); text-decoration: none; padding: 6px 12px; border: 1px solid var(--border); transition: color 0.15s, border-color 0.15s; }
  .back-link:hover { color: var(--text); border-color: var(--text-dim); }

  /* GAME LAYOUT */
  .game-wrap { position: relative; z-index: 1; min-height: calc(100vh - 56px); display: flex; flex-direction: column; }

  /* HEADER BAR */
  .game-header { padding: 24px 40px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
  .game-title-row { display: flex; flex-direction: column; gap: 4px; }
  .game-eyebrow { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--blue); }
  .game-title { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 700; }
  .streak-display { display: flex; flex-direction: column; align-items: flex-end; gap: 2px; }
  .streak-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); }
  .streak-num { font-family: 'Playfair Display', serif; font-size: 40px; font-weight: 900; color: var(--amber); line-height: 1; transition: color 0.2s; }
  .streak-best { font-size: 10px; color: var(--text-muted); letter-spacing: 1px; }

  /* PROMPT */
  .game-prompt { padding: 32px 40px 20px; text-align: center; }
  .prompt-text { font-size: 12px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-dim); }

  /* VS ARENA */
  .arena { display: grid; grid-template-columns: 1fr auto 1fr; gap: 0; flex: 1; border-top: 1px solid var(--border); }
  .artist-side { padding: 48px 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 16px; cursor: pointer; transition: background 0.15s; position: relative; overflow: hidden; }
  .artist-side::before { content: ''; position: absolute; inset: 0; opacity: 0; transition: opacity 0.25s; }
  .artist-side.left::before { background: radial-gradient(ellipse 80% 60% at 20% 50%, rgba(93,143,232,0.15) 0%, transparent 70%); }
  .artist-side.right::before { background: radial-gradient(ellipse 80% 60% at 80% 50%, rgba(93,186,127,0.15) 0%, transparent 70%); }
  .artist-side:hover::before { opacity: 1; }
  .artist-side:hover { background: var(--surface); }
  .artist-side:hover .artist-btn { background: var(--blue); color: #0a0810; border-color: var(--blue); }
  .artist-side.right:hover .artist-btn { background: var(--green); color: #0a0810; border-color: var(--green); }

  .artist-side.correct { background: rgba(93,186,127,0.08); }
  .artist-side.wrong  { background: rgba(232,93,74,0.08); }

  .artist-name-big { font-family: 'Playfair Display', serif; font-size: clamp(24px, 3.5vw, 48px); font-weight: 900; text-align: center; line-height: 1.1; }
  .artist-song-count { font-size: 11px; color: var(--text-muted); letter-spacing: 1px; display: none; }
  .artist-side.revealed .artist-song-count { display: block; }
  .artist-side.revealed .artist-name-big { color: var(--green); }
  .artist-side.revealed.wrong .artist-name-big { color: var(--red); }

  .artist-count-big { font-family: 'Playfair Display', serif; font-size: 64px; font-weight: 900; color: var(--green); display: none; line-height: 1; }
  .artist-side.wrong .artist-count-big { color: var(--red); }
  .artist-side.revealed .artist-count-big { display: block; }

  .artist-btn { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; padding: 10px 24px; border: 1px solid var(--border); color: var(--text-dim); background: transparent; cursor: pointer; transition: all 0.15s; font-family: 'Space Mono', monospace; margin-top: 8px; }

  .vs-divider { display: flex; align-items: center; justify-content: center; padding: 0 24px; border-left: 1px solid var(--border); border-right: 1px solid var(--border); }
  .vs-text { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 900; color: var(--text-muted); }

  /* RESULT BANNER */
  .result-banner { display: none; padding: 16px 40px; text-align: center; border-top: 1px solid var(--border); }
  .result-banner.correct { background: rgba(93,186,127,0.1); border-top-color: var(--green); }
  .result-banner.wrong { background: rgba(232,93,74,0.1); border-top-color: var(--red); }
  .result-banner.tie { background: rgba(155,109,255,0.1); border-top-color: var(--amber); }
  .result-text { font-size: 13px; letter-spacing: 1px; }
  .result-text strong { color: var(--green); }
  .result-banner.wrong .result-text strong { color: var(--red); }
  .result-next { margin-top: 12px; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); cursor: pointer; background: none; border: 1px solid var(--border); padding: 8px 20px; font-family: 'Space Mono', monospace; color: var(--text); transition: background 0.15s; }
  .result-next:hover { background: var(--surface2); }

  /* GAME OVER */
  .gameover { display: none; flex-direction: column; align-items: center; justify-content: center; gap: 24px; padding: 80px 40px; flex: 1; }
  .gameover-title { font-family: 'Playfair Display', serif; font-size: 48px; font-weight: 900; }
  .gameover-sub { font-size: 12px; color: var(--text-dim); letter-spacing: 2px; text-transform: uppercase; }
  .gameover-score { font-family: 'Playfair Display', serif; font-size: 96px; font-weight: 900; color: var(--amber); line-height: 1; }
  .gameover-label { font-size: 11px; color: var(--text-muted); letter-spacing: 3px; text-transform: uppercase; }
  .restart-btn { font-size: 11px; letter-spacing: 2px; text-transform: uppercase; padding: 14px 32px; border: 1px solid var(--amber); color: var(--amber); background: transparent; cursor: pointer; font-family: 'Space Mono', monospace; transition: background 0.15s, color 0.15s; }
  .restart-btn:hover { background: var(--amber); color: #0a0810; }

  /* LOADING */
  .loading { display: flex; align-items: center; justify-content: center; flex: 1; font-size: 11px; color: var(--text-muted); letter-spacing: 3px; text-transform: uppercase; }

  @media (max-width: 700px) {
    .site-nav { padding: 0 16px; }
    .game-header { padding: 16px; }
    .game-prompt { padding: 20px 16px 12px; }
    .arena { grid-template-columns: 1fr; grid-template-rows: 1fr auto 1fr; }
    .vs-divider { border: none; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); padding: 12px; }
    .artist-side { padding: 32px 16px; }
  }
</style>
</head>
<body>

<nav class="site-nav">
  <a class="site-logo" href="index.html">Daily <span>Jam</span></a>
  <div class="nav-links">
    <a class="nav-link" href="index.html">Home</a>
    <a class="nav-link" href="catalog.html">Catalog</a>
    <a class="nav-link" href="calendar.html">Calendar</a>
    <a class="nav-link" href="stats.html">Stats</a>
    <a class="nav-link" href="shuffle.html">Shuffle</a>
    <a class="nav-link active" href="games.html">Games</a>
    <a class="nav-link" href="daily-jam-links.html">Links</a>
  </div>
</nav>

<div class="game-wrap">
  <div class="game-header">
    <div class="game-title-row">
      <div class="game-eyebrow">Game 01</div>
      <div class="game-title">Head to Head</div>
    </div>
    <div class="streak-display">
      <div class="streak-label">Streak</div>
      <div class="streak-num" id="streak">0</div>
      <div class="streak-best" id="best-streak">Best: 0</div>
    </div>
  </div>

  <div id="loading-state" class="loading">Loading catalog...</div>

  <div id="game-state" style="display:none; flex-direction:column; flex:1;">
    <div class="game-prompt">
      <p class="prompt-text">Which artist has more songs in the Daily Jam catalog?</p>
    </div>

    <div class="arena">
      <div class="artist-side left" id="side-a" onclick="guess('a')">
        <div class="artist-name-big" id="name-a">—</div>
        <div class="artist-count-big" id="count-a">0</div>
        <div class="artist-song-count" id="label-a">songs</div>
        <button class="artist-btn" tabindex="-1">Pick this one</button>
      </div>
      <div class="vs-divider">
        <div class="vs-text">vs</div>
      </div>
      <div class="artist-side right" id="side-b" onclick="guess('b')">
        <div class="artist-name-big" id="name-b">—</div>
        <div class="artist-count-big" id="count-b">0</div>
        <div class="artist-song-count" id="label-b">songs</div>
        <button class="artist-btn" tabindex="-1">Pick this one</button>
      </div>
    </div>

    <div class="result-banner" id="result-banner">
      <div class="result-text" id="result-text"></div>
      <button class="result-next" onclick="nextRound()">Next Round →</button>
    </div>
  </div>

  <div class="gameover" id="gameover-state">
    <div class="gameover-sub">Game Over — Streak Ended</div>
    <div class="gameover-title">Your Best</div>
    <div class="gameover-score" id="final-score">0</div>
    <div class="gameover-label">Streak</div>
    <button class="restart-btn" onclick="restartGame()">Play Again</button>
  </div>
</div>

<script>
let allSongs = [];
let artistCounts = {};
let artistList = [];
let streak = 0;
let bestStreak = 0;
let answered = false;
let currentA, currentB;

async function loadData() {
  try {
    const arrays = await Promise.all([1,2,3,4,5,6,7,8].map(y =>
      fetch(`songs-dj${y}.json`)
        .then(r => r.text())
        .then(txt => { if (txt.charCodeAt(0) === 0xFEFF) txt = txt.slice(1); return JSON.parse(txt); })
    ));
    allSongs = arrays.flat();

    // Count songs per artist (lead artist only)
    allSongs.forEach(s => {
      const artist = s[3];
      artistCounts[artist] = (artistCounts[artist] || 0) + 1;
    });

    // Only use artists with at least 2 songs for interesting matchups
    artistList = Object.entries(artistCounts)
      .filter(([, count]) => count >= 2)
      .map(([name, count]) => ({ name, count }));

    document.getElementById('loading-state').style.display = 'none';
    document.getElementById('game-state').style.display = 'flex';
    nextRound();
  } catch(e) {
    document.getElementById('loading-state').textContent = 'Failed to load catalog.';
  }
}

function pickTwo() {
  const shuffled = [...artistList].sort(() => Math.random() - 0.5);
  // Avoid ties when possible
  let a = shuffled[0], b = shuffled[1];
  // Try a few times to avoid exact tie
  for (let i = 1; i < shuffled.length; i++) {
    if (shuffled[i].count !== a.count) { b = shuffled[i]; break; }
  }
  return [a, b];
}

function nextRound() {
  answered = false;
  const banner = document.getElementById('result-banner');
  banner.style.display = 'none';
  banner.className = 'result-banner';

  const [a, b] = pickTwo();
  currentA = a; currentB = b;

  document.getElementById('name-a').textContent = a.name;
  document.getElementById('name-b').textContent = b.name;
  document.getElementById('count-a').textContent = a.count;
  document.getElementById('count-b').textContent = b.count;
  document.getElementById('label-a').textContent = a.count === 1 ? 'song' : 'songs';
  document.getElementById('label-b').textContent = b.count === 1 ? 'song' : 'songs';

  const sideA = document.getElementById('side-a');
  const sideB = document.getElementById('side-b');
  sideA.className = 'artist-side left';
  sideB.className = 'artist-side right';
}

function guess(side) {
  if (answered) return;
  answered = true;

  const a = currentA, b = currentB;
  const sideA = document.getElementById('side-a');
  const sideB = document.getElementById('side-b');

  let correct;
  if (a.count === b.count) {
    // Tie — always "correct"
    correct = true;
  } else {
    const winner = a.count > b.count ? 'a' : 'b';
    correct = (side === winner);
  }

  sideA.classList.add('revealed');
  sideB.classList.add('revealed');

  const banner = document.getElementById('result-banner');
  const resultText = document.getElementById('result-text');

  if (a.count === b.count) {
    sideA.classList.add('correct');
    sideB.classList.add('correct');
    banner.classList.add('tie');
    resultText.innerHTML = `It's a tie! Both have <strong>${a.count}</strong> songs. Point awarded.`;
    streak++;
  } else if (correct) {
    const pickedSide = side === 'a' ? sideA : sideB;
    const otherSide  = side === 'a' ? sideB : sideA;
    pickedSide.classList.add('correct');
    otherSide.classList.add('wrong');
    banner.classList.add('correct');
    const winner = a.count > b.count ? a : b;
    const loser  = a.count > b.count ? b : a;
    resultText.innerHTML = `Correct! <strong>${winner.name}</strong> has ${winner.count} songs vs ${loser.name}'s ${loser.count}.`;
    streak++;
  } else {
    const pickedSide = side === 'a' ? sideA : sideB;
    const otherSide  = side === 'a' ? sideB : sideA;
    pickedSide.classList.add('wrong');
    otherSide.classList.add('correct');
    banner.classList.add('wrong');
    const winner = a.count > b.count ? a : b;
    const loser  = a.count > b.count ? b : a;
    resultText.innerHTML = `Wrong! <strong>${winner.name}</strong> has ${winner.count} songs vs ${loser.name}'s ${loser.count}.`;
  }

  if (streak > bestStreak) bestStreak = streak;
  document.getElementById('streak').textContent = streak;
  document.getElementById('best-streak').textContent = `Best: ${bestStreak}`;

  banner.style.display = 'block';

  if (!correct && a.count !== b.count) {
    // Game over after wrong answer
    setTimeout(() => showGameOver(), 1200);
  }
}

function showGameOver() {
  document.getElementById('game-state').style.display = 'none';
  document.getElementById('final-score').textContent = bestStreak;
  const go = document.getElementById('gameover-state');
  go.style.display = 'flex';
}

function restartGame() {
  streak = 0;
  document.getElementById('streak').textContent = 0;
  document.getElementById('best-streak').textContent = `Best: ${bestStreak}`;
  document.getElementById('gameover-state').style.display = 'none';
  document.getElementById('game-state').style.display = 'flex';
  nextRound();
}

loadData();
</script>
</body>
</html>
