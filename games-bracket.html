<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Jam â€” March Madness Bracket</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0e0c0f; --surface: #161418; --surface2: #1e1b21; --border: #272330;
    --amber: #9b6dff; --amber-glow: rgba(155,109,255,0.12);
    --text: #e8e0d0; --text-dim: #9e9080; --text-muted: #6a6460;
    --green: #5dba7f; --red: #e85d4a;
    --y1:#5d8fe8; --y2:#5dba7f; --y3:#e85d8f; --y4:#e8a45d;
    --y5:#a45de8; --y6:#5de8e8; --y7:#e8e85d; --y8:#FF6B6B;
    --cc: #FF6B6B; /* card color */
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: #0a0810; color: var(--text); font-family: 'Space Mono', monospace; min-height: 100vh; overflow-x: hidden; }
  body::before { content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 0;
    background:
      radial-gradient(ellipse 90% 70% at 5%  0%,   rgba(155,109,255,0.38) 0%, transparent 65%),
      radial-gradient(ellipse 70% 60% at 95% 100%,  rgba(93,143,232,0.28)  0%, transparent 60%),
      radial-gradient(ellipse 55% 45% at 88% 5%,    rgba(232,93,143,0.18)  0%, transparent 55%),
      radial-gradient(ellipse 50% 40% at 3%  95%,   rgba(93,186,127,0.18)  0%, transparent 55%); }
  body::after { content: ''; position: fixed; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E"); pointer-events: none; z-index: 9999; opacity: 0.4; }

  /* â”€â”€ NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .site-nav { position: sticky; top: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between; padding: 0 40px; height: 56px; background: rgba(14,12,15,0.95); border-bottom: 1px solid var(--border); backdrop-filter: blur(8px); }
  .site-logo { font-family: 'Space Mono', monospace; font-size: 16px; font-weight: 700; color: var(--text); text-decoration: none; letter-spacing: 1px; }
  .site-logo span { color: var(--amber); font-style: italic; }
  .nav-links { display: flex; gap: 4px; align-items: center; }
  .nav-link { font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-dim); text-decoration: none; padding: 8px 14px; transition: color 0.15s; }
  .nav-link:hover { color: var(--text); }
  .nav-link.active { color: var(--amber); }

  /* â”€â”€ SETUP SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .setup-screen { position: relative; z-index: 1; padding: 64px 40px 80px; max-width: 860px; margin: 0 auto; }
  .setup-eyebrow { font-size: 11px; letter-spacing: 4px; text-transform: uppercase; color: var(--cc); margin-bottom: 16px; }
  .setup-title { font-family: 'Playfair Display', serif; font-size: clamp(40px, 6vw, 80px); font-weight: 900; line-height: 0.92; letter-spacing: -2px; margin-bottom: 24px; }
  .setup-title em { color: var(--cc); font-style: italic; }
  .setup-sub { font-size: 12px; color: var(--text-dim); line-height: 1.9; max-width: 560px; margin-bottom: 48px; }

  .setup-section { margin-bottom: 36px; }
  .setup-section-label { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-muted); margin-bottom: 16px; }

  .year-filter { display: flex; gap: 8px; flex-wrap: wrap; }
  .year-btn { background: var(--surface); border: 1px solid var(--border); color: var(--text-dim); font-family: 'Space Mono', monospace; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; padding: 10px 18px; cursor: pointer; transition: all 0.15s; }
  .year-btn:hover { border-color: var(--text-dim); color: var(--text); }
  .year-btn.selected { border-color: var(--btn-color, var(--cc)); color: var(--btn-color, var(--cc)); background: rgba(255,107,107,0.06); }

  .start-btn { background: var(--cc); color: #0a0810; font-family: 'Space Mono', monospace; font-size: 12px; font-weight: 700; letter-spacing: 3px; text-transform: uppercase; padding: 16px 40px; border: none; cursor: pointer; transition: opacity 0.15s; }
  .start-btn:hover { opacity: 0.85; }
  .start-btn:disabled { opacity: 0.3; cursor: not-allowed; }

  .resume-notice { margin-top: 20px; font-size: 11px; color: var(--text-muted); letter-spacing: 1px; line-height: 1.7; }
  .resume-link { color: var(--cc); cursor: pointer; text-decoration: underline; background: none; border: none; font-family: inherit; font-size: inherit; padding: 0; }

  /* â”€â”€ GAME WRAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .game-wrap { position: relative; z-index: 1; display: none; flex-direction: column; min-height: calc(100vh - 56px); }

  /* â”€â”€ GAME HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .game-header { padding: 16px 40px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; gap: 16px; flex-wrap: wrap; }
  .game-title-row { display: flex; flex-direction: column; gap: 3px; flex-shrink: 0; }
  .game-eyebrow { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--cc); }
  .game-title-text { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 700; }

  .round-info { display: flex; flex-direction: column; align-items: center; gap: 4px; flex: 1; min-width: 120px; }
  .round-label { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-muted); }
  .round-name  { font-size: 14px; font-weight: 700; color: var(--cc); letter-spacing: 1px; }

  .header-right { display: flex; align-items: center; gap: 12px; flex-shrink: 0; }
  .hdr-btns { display: flex; gap: 8px; }
  .hdr-btn { background: none; border: 1px solid var(--border); color: var(--text-dim); font-family: 'Space Mono', monospace; font-size: 9px; letter-spacing: 2px; text-transform: uppercase; padding: 7px 13px; cursor: pointer; transition: all 0.15s; }
  .hdr-btn:hover { color: var(--text); border-color: var(--text-dim); }

  .matchup-counter { display: flex; flex-direction: column; align-items: flex-end; gap: 2px; }
  .mc-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); }
  .mc-nums { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 900; color: var(--amber); line-height: 1; }

  /* â”€â”€ PROGRESS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .round-bar { height: 3px; background: var(--surface2); }
  .round-bar-fill { height: 100%; background: var(--cc); transition: width 0.4s ease; width: 0%; }

  /* â”€â”€ LOADING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .loading { display: flex; align-items: center; justify-content: center; padding: 80px 40px; font-size: 11px; color: var(--text-muted); letter-spacing: 3px; text-transform: uppercase; flex: 1; }

  /* â”€â”€ MATCHUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .matchup-screen { flex: 1; display: flex; flex-direction: column; padding: 36px 40px; gap: 24px; max-width: 820px; margin: 0 auto; width: 100%; }

  .matchup-tag { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-muted); text-align: center; }

  .vs-grid { display: grid; grid-template-columns: 1fr auto 1fr; gap: 16px; align-items: stretch; }

  .song-card { background: var(--surface); border: 2px solid var(--border); padding: 28px 24px 24px; cursor: pointer; transition: border-color 0.15s, background 0.15s; display: flex; flex-direction: column; gap: 8px; position: relative; overflow: hidden; }
  .song-card::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: var(--cc); transform: scaleX(0); transform-origin: left; transition: transform 0.2s; }
  .song-card:hover { border-color: var(--cc); background: var(--surface2); }
  .song-card:hover::after { transform: scaleX(1); }
  .song-card.picked  { border-color: var(--green); cursor: default; background: rgba(93,186,127,0.05); }
  .song-card.picked::after { background: var(--green); transform: scaleX(1); }
  .song-card.dropped { border-color: var(--border); opacity: 0.35; cursor: default; }
  .song-card.dropped::after { display: none; }

  .card-seed   { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); }
  .card-title  { font-family: 'Playfair Display', serif; font-size: clamp(15px, 2.2vw, 22px); font-weight: 700; line-height: 1.2; flex: 1; }
  .card-artist { font-size: 11px; color: var(--text-dim); }
  .card-yr     { display: inline-block; font-size: 9px; letter-spacing: 2px; text-transform: uppercase; padding: 3px 8px; border: 1px solid; margin-top: 2px; }

  .vs-mid { display: flex; align-items: center; justify-content: center; }
  .vs-word { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 900; color: var(--text-muted); user-select: none; }

  .vote-msg { text-align: center; font-size: 11px; color: var(--text-muted); letter-spacing: 2px; text-transform: uppercase; min-height: 18px; }
  .vote-msg.confirmed { color: var(--green); }

  .next-btn { align-self: center; background: var(--cc); color: #0a0810; font-family: 'Space Mono', monospace; font-size: 11px; font-weight: 700; letter-spacing: 3px; text-transform: uppercase; padding: 13px 32px; border: none; cursor: pointer; transition: opacity 0.15s; display: none; }
  .next-btn:hover { opacity: 0.85; }

  /* â”€â”€ ROUND COMPLETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .round-complete { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; gap: 20px; padding: 60px 40px; text-align: center; }
  .rc-eye  { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--text-muted); }
  .rc-head { font-family: 'Playfair Display', serif; font-size: clamp(30px, 5vw, 60px); font-weight: 900; color: var(--cc); }
  .rc-sub  { font-size: 12px; color: var(--text-dim); max-width: 440px; line-height: 1.9; }
  .rc-advancers { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; max-width: 680px; margin: 8px 0; }
  .rc-song-chip { font-size: 10px; background: var(--surface); border: 1px solid var(--border); padding: 6px 12px; color: var(--text-dim); white-space: nowrap; max-width: 220px; overflow: hidden; text-overflow: ellipsis; }
  .rc-btn { background: var(--cc); color: #0a0810; font-family: 'Space Mono', monospace; font-size: 11px; font-weight: 700; letter-spacing: 3px; text-transform: uppercase; padding: 14px 36px; border: none; cursor: pointer; transition: opacity 0.15s; }
  .rc-btn:hover { opacity: 0.85; }

  /* â”€â”€ CHAMPION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .champion-screen { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; gap: 16px; padding: 60px 40px; text-align: center; }
  .champ-trophy { font-size: 60px; line-height: 1; }
  .champ-eye    { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--text-muted); }
  .champ-crown  { font-family: 'Playfair Display', serif; font-size: clamp(32px, 5vw, 64px); font-weight: 900; color: var(--y7); }
  .champ-song   { font-family: 'Playfair Display', serif; font-size: clamp(22px, 4vw, 44px); font-weight: 700; color: var(--text); max-width: 680px; line-height: 1.2; margin-top: 4px; }
  .champ-artist { font-size: 15px; color: var(--text-dim); margin-top: 4px; }
  .champ-yr     { font-size: 12px; letter-spacing: 2px; margin-top: 4px; }
  .champ-actions { display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
  .champ-btn { font-family: 'Space Mono', monospace; font-size: 11px; font-weight: 700; letter-spacing: 3px; text-transform: uppercase; padding: 13px 28px; border: none; cursor: pointer; transition: opacity 0.15s; }
  .champ-btn.primary   { background: var(--cc); color: #0a0810; }
  .champ-btn.secondary { background: transparent; border: 1px solid var(--border); color: var(--text-dim); }
  .champ-btn:hover { opacity: 0.8; }

  /* â”€â”€ BRACKET VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .bracket-view { flex: 1; display: none; flex-direction: column; padding: 28px 40px 60px; overflow-x: auto; }
  .bv-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; gap: 12px; flex-wrap: wrap; }
  .bv-title  { font-size: 11px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-muted); }
  .bv-back   { background: none; border: 1px solid var(--border); color: var(--text-dim); font-family: 'Space Mono', monospace; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; padding: 8px 16px; cursor: pointer; transition: all 0.15s; }
  .bv-back:hover { color: var(--text); border-color: var(--text-dim); }

  .bv-rounds { display: flex; gap: 0; min-width: max-content; border: 1px solid var(--border); }
  .bv-col  { display: flex; flex-direction: column; border-right: 1px solid var(--border); min-width: 190px; }
  .bv-col:last-child { border-right: none; }
  .bv-col-hd { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-muted); padding: 10px 14px; border-bottom: 1px solid var(--border); text-align: center; background: var(--surface); }
  .bv-slots { display: flex; flex-direction: column; flex: 1; justify-content: space-around; padding: 6px 0; }
  .bv-matchup { padding: 4px 10px; display: flex; flex-direction: column; gap: 2px; }
  .bv-entry { font-size: 10px; color: var(--text-dim); padding: 5px 8px; border-left: 2px solid var(--surface2); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 170px; display: flex; align-items: center; gap: 5px; }
  .bv-entry.winner  { border-left-color: var(--green); color: var(--text); font-weight: 700; }
  .bv-entry.loser   { opacity: 0.35; }
  .bv-entry.pending { color: var(--text-muted); font-style: italic; }
  .bv-seed { font-size: 8px; color: var(--text-muted); flex-shrink: 0; min-width: 22px; }
  .bv-vs   { font-size: 8px; color: var(--text-muted); padding: 1px 8px 1px 28px; }
  .bv-champion-col .bv-entry { border-left-color: var(--y7); color: var(--y7); font-weight: 700; font-size: 11px; }

  @media (max-width: 900px) {
    .site-nav { padding: 0 16px; }
    .setup-screen { padding: 40px 16px 60px; }
    .game-header { padding: 12px 16px; }
    .matchup-screen { padding: 20px 16px; gap: 16px; }
    .vs-grid { grid-template-columns: 1fr; gap: 10px; }
    .vs-mid { display: none; }
    .bracket-view { padding: 20px 16px 40px; }
    .bv-col { min-width: 150px; }
  }
  @media (max-width: 600px) {
    .nav-links .nav-link { padding: 8px 8px; font-size: 10px; }
    .game-header { flex-wrap: wrap; gap: 8px; }
    .champ-actions { flex-direction: column; align-items: center; }
    .round-info { display: none; }
  }
</style>
</head>
<body>

<nav class="site-nav">
  <a class="site-logo" href="index.html">Daily <span>Jam</span></a>
  <div class="nav-links">
    <a class="nav-link" href="index.html">Home</a>
    <a class="nav-link" href="catalog.html">Catalog</a>
    <a class="nav-link" href="calendar.html">Calendar</a>
    <a class="nav-link" href="stats.html">Stats</a>
    <a class="nav-link" href="shuffle.html">Shuffle</a>
    <a class="nav-link active" href="games.html">Games</a>
    <a class="nav-link" href="daily-jam-links.html">Links</a>
  </div>
</nav>

<!-- â•â•â• SETUP SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="setup-screen" id="setup-screen">
  <p class="setup-eyebrow">Game 05</p>
  <h1 class="setup-title">March Madness<br><em>Bracket</em></h1>
  <p class="setup-sub">64 songs enter, one leaves. Songs are seeded by popularity then paired head-to-head â€” vote for your favourite each round until a champion is crowned. Your bracket saves automatically so you can pick up where you left off.</p>

  <div class="setup-section">
    <p class="setup-section-label">Draw from</p>
    <div class="year-filter" id="year-filter">
      <button class="year-btn" data-year="all" style="--btn-color:var(--amber)">All Years</button>
      <button class="year-btn" data-year="1"   style="--btn-color:var(--y1)">DJ1</button>
      <button class="year-btn" data-year="2"   style="--btn-color:var(--y2)">DJ2</button>
      <button class="year-btn" data-year="3"   style="--btn-color:var(--y3)">DJ3</button>
      <button class="year-btn" data-year="4"   style="--btn-color:var(--y4)">DJ4</button>
      <button class="year-btn" data-year="5"   style="--btn-color:var(--y5)">DJ5</button>
      <button class="year-btn" data-year="6"   style="--btn-color:var(--y6)">DJ6</button>
      <button class="year-btn" data-year="7"   style="--btn-color:var(--y7)">DJ7</button>
      <button class="year-btn" data-year="8"   style="--btn-color:var(--y8)">DJ8</button>
    </div>
  </div>

  <div class="setup-section">
    <button class="start-btn" id="start-btn" disabled>Build Bracket â†’</button>
    <div class="resume-notice" id="resume-notice" style="display:none">
      You have a saved bracket. <button class="resume-link" id="resume-btn">Resume it â†’</button>
      &nbsp;or start a fresh one above.
    </div>
  </div>
</div>

<!-- â•â•â• GAME WRAP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="game-wrap" id="game-wrap">

  <!-- HEADER -->
  <div class="game-header">
    <div class="game-title-row">
      <span class="game-eyebrow">Game 05 Â· March Madness</span>
      <span class="game-title-text">Bracket</span>
    </div>
    <div class="round-info">
      <span class="round-label">Round</span>
      <span class="round-name" id="round-name">â€”</span>
    </div>
    <div class="header-right">
      <div class="hdr-btns">
        <button class="hdr-btn" id="view-btn">View Bracket</button>
        <button class="hdr-btn" id="reset-btn">Reset</button>
      </div>
      <div class="matchup-counter">
        <span class="mc-label">Matchup</span>
        <span class="mc-nums" id="mc-nums">â€” / â€”</span>
      </div>
    </div>
  </div>

  <!-- PROGRESS BAR -->
  <div class="round-bar"><div class="round-bar-fill" id="bar-fill"></div></div>

  <!-- LOADING -->
  <div class="loading" id="loading-msg">Loading catalogâ€¦</div>

  <!-- MATCHUP -->
  <div class="matchup-screen" id="matchup-screen" style="display:none">
    <div class="matchup-tag" id="matchup-tag"></div>
    <div class="vs-grid">
      <div class="song-card" id="card-a" onclick="castVote(0)">
        <span class="card-seed" id="seed-a"></span>
        <span class="card-title" id="title-a"></span>
        <span class="card-artist" id="artist-a"></span>
        <span class="card-yr" id="yr-a"></span>
      </div>
      <div class="vs-mid"><span class="vs-word">VS</span></div>
      <div class="song-card" id="card-b" onclick="castVote(1)">
        <span class="card-seed" id="seed-b"></span>
        <span class="card-title" id="title-b"></span>
        <span class="card-artist" id="artist-b"></span>
        <span class="card-yr" id="yr-b"></span>
      </div>
    </div>
    <p class="vote-msg" id="vote-msg">Click a song to vote â†’</p>
    <button class="next-btn" id="next-btn" onclick="advanceMatchup()">Next Matchup â†’</button>
  </div>

  <!-- ROUND COMPLETE -->
  <div class="round-complete" id="round-complete">
    <p class="rc-eye">Round Complete</p>
    <h2 class="rc-head" id="rc-head"></h2>
    <p class="rc-sub" id="rc-sub"></p>
    <div class="rc-advancers" id="rc-advancers"></div>
    <button class="rc-btn" onclick="startNextRound()">Continue â†’</button>
  </div>

  <!-- CHAMPION -->
  <div class="champion-screen" id="champion-screen">
    <div class="champ-trophy">ğŸ†</div>
    <p class="champ-eye">Tournament Champion</p>
    <h2 class="champ-crown">Champion!</h2>
    <p class="champ-song"   id="champ-song"></p>
    <p class="champ-artist" id="champ-artist"></p>
    <p class="champ-yr"     id="champ-yr"></p>
    <div class="champ-actions">
      <button class="champ-btn primary"   onclick="newBracket()">New Bracket â†’</button>
      <button class="champ-btn secondary" onclick="showBracketView()">View Full Bracket</button>
    </div>
  </div>

  <!-- BRACKET VIEW -->
  <div class="bracket-view" id="bracket-view">
    <div class="bv-header">
      <span class="bv-title">Full Bracket</span>
      <button class="bv-back" onclick="hideBracketView()">â† Back</button>
    </div>
    <div class="bv-rounds" id="bv-rounds"></div>
  </div>

</div><!-- /game-wrap -->

<script>
// â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DJ_YEARS = [
  { num:1, label:'DJ1', color:'#5d8fe8', start:'2018-09-24', end:'2019-09-23' },
  { num:2, label:'DJ2', color:'#5dba7f', start:'2019-09-24', end:'2020-09-23' },
  { num:3, label:'DJ3', color:'#e85d8f', start:'2020-09-24', end:'2021-09-23' },
  { num:4, label:'DJ4', color:'#e8a45d', start:'2021-09-24', end:'2022-09-23' },
  { num:5, label:'DJ5', color:'#a45de8', start:'2022-09-24', end:'2023-09-23' },
  { num:6, label:'DJ6', color:'#5de8e8', start:'2023-09-24', end:'2024-09-23' },
  { num:7, label:'DJ7', color:'#e8e85d', start:'2024-09-24', end:'2025-09-23' },
  { num:8, label:'DJ8', color:'#FF6B6B', start:'2025-09-24', end:'2026-09-23' },
];
const ROUND_NAMES = ['Round of 64','Round of 32','Sweet 16','Elite Eight','Final Four','Championship'];
const BRACKET_SIZE = 64;
const STORAGE_KEY  = 'dj-bracket-v3';

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let loadedYears = {};
let allSongs    = [];
let bracket     = null;
let selectedFilter = null;

// â”€â”€ SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.querySelectorAll('.year-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.year-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    selectedFilter = btn.dataset.year;
    document.getElementById('start-btn').disabled = false;
  });
});
document.getElementById('start-btn').addEventListener('click', () => startNewBracket(selectedFilter));
document.getElementById('resume-btn').addEventListener('click', resumeBracket);
document.getElementById('view-btn').addEventListener('click', showBracketView);
document.getElementById('reset-btn').addEventListener('click', () => {
  if (confirm('Reset this bracket and start over?')) {
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  }
});

// Check for saved bracket on load
(function checkSaved() {
  try {
    const b = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
    if (b && b.seeds && b.rounds) document.getElementById('resume-notice').style.display = 'block';
  } catch(e) {}
})();

// â”€â”€ LOAD DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadAllSongs() {
  if (allSongs.length) return; // already loaded
  const arrays = await Promise.all([1,2,3,4,5,6,7,8].map(y =>
    fetch(`songs-dj${y}.json`)
      .then(r => r.text())
      .then(txt => { if (txt.charCodeAt(0) === 0xFEFF) txt = txt.slice(1); return JSON.parse(txt); })
  ));
  arrays.forEach((arr, i) => { loadedYears[i+1] = arr; });
  allSongs = arrays.flat();
}

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getDJYear(dateStr) {
  return DJ_YEARS.find(y => dateStr >= y.start && dateStr <= y.end) || DJ_YEARS[0];
}
function rnd(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
function esc(s) {
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// â”€â”€ BRACKET BUILD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pickSeeds(filter) {
  let pool = filter === 'all' ? [...allSongs]
           : (loadedYears[parseInt(filter)] ? [...loadedYears[parseInt(filter)]] : [...allSongs]);

  // If pool < 64, pad from rest of catalog
  if (pool.length < BRACKET_SIZE) {
    const extra = rnd(allSongs.filter(s => !pool.includes(s)));
    pool = [...pool, ...extra];
  }

  // Shuffle then sort by popularity for seeding
  const picked = rnd(pool).slice(0, BRACKET_SIZE);
  picked.sort((a, b) => (b[8] || 0) - (a[8] || 0));
  return picked;
}

function buildRound0(seeds) {
  // 1 vs 64, 2 vs 63 â€¦ 32 vs 33
  const matchups = [];
  for (let i = 0; i < 32; i++) {
    matchups.push({ songA: seeds[i], songB: seeds[63 - i], seedA: i + 1, seedB: 64 - i, winner: null });
  }
  return matchups;
}

// â”€â”€ START / RESUME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function startNewBracket(filter) {
  showGameWrap();
  document.getElementById('loading-msg').style.display = 'flex';
  await loadAllSongs();

  const seeds  = pickSeeds(filter);
  const round0 = buildRound0(seeds);
  bracket = { filter, seeds, rounds: [round0], currentRound: 0, currentMatchup: 0, champion: null };
  save();

  document.getElementById('loading-msg').style.display = 'none';
  renderMatchup();
}

async function resumeBracket() {
  try {
    bracket = JSON.parse(localStorage.getItem(STORAGE_KEY));
  } catch(e) { return; }
  if (!bracket) return;

  showGameWrap();
  document.getElementById('loading-msg').style.display = 'flex';
  await loadAllSongs();
  document.getElementById('loading-msg').style.display = 'none';

  if (bracket.champion) showChampion(bracket.champion);
  else                  renderMatchup();
}

function showGameWrap() {
  document.getElementById('setup-screen').style.display = 'none';
  const gw = document.getElementById('game-wrap');
  gw.style.display = 'flex';
}

function newBracket() {
  localStorage.removeItem(STORAGE_KEY);
  location.reload();
}

function save() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(bracket));
}

// â”€â”€ RENDER MATCHUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function hideAllScreens() {
  document.getElementById('matchup-screen').style.display = 'none';
  document.getElementById('round-complete').style.display = 'none';
  document.getElementById('champion-screen').style.display = 'none';
  document.getElementById('bracket-view').style.display   = 'none';
  document.getElementById('loading-msg').style.display    = 'none';
}

function renderMatchup() {
  hideAllScreens();
  document.getElementById('matchup-screen').style.display = 'flex';

  const round   = bracket.rounds[bracket.currentRound];
  const matchup = round[bracket.currentMatchup];
  const total   = round.length;
  const done    = round.filter(m => m.winner !== null).length;
  const rName   = ROUND_NAMES[bracket.currentRound] || `Round ${bracket.currentRound + 1}`;

  // Header
  document.getElementById('round-name').textContent = rName;
  document.getElementById('mc-nums').textContent    = `${bracket.currentMatchup + 1} / ${total}`;
  document.getElementById('matchup-tag').textContent = `${rName} Â· Matchup ${bracket.currentMatchup + 1} of ${total}`;
  document.getElementById('bar-fill').style.width   = (done / total * 100) + '%';

  // Cards
  fillCard('a', matchup.songA, matchup.seedA);
  fillCard('b', matchup.songB, matchup.seedB);

  // Reset state
  const ca = document.getElementById('card-a');
  const cb = document.getElementById('card-b');
  ca.className = 'song-card'; ca.onclick = () => castVote(0);
  cb.className = 'song-card'; cb.onclick = () => castVote(1);
  document.getElementById('vote-msg').textContent  = 'Click a song to vote â†’';
  document.getElementById('vote-msg').className    = 'vote-msg';
  document.getElementById('next-btn').style.display = 'none';

  // If this matchup already has a vote (resume scenario)
  if (matchup.winner !== null) applyVoteUI(matchup.winner, matchup.winner === 0 ? matchup.songA : matchup.songB);
}

function fillCard(side, song, seed) {
  const yr = getDJYear(song[5]);
  document.getElementById(`seed-${side}`).textContent    = `#${seed} Seed`;
  document.getElementById(`title-${side}`).textContent   = song[2];
  document.getElementById(`artist-${side}`).textContent  = song[3];
  const yrEl = document.getElementById(`yr-${side}`);
  yrEl.textContent          = yr.label;
  yrEl.style.color          = yr.color;
  yrEl.style.borderColor    = yr.color;
}

// â”€â”€ VOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function castVote(side) {
  const round   = bracket.rounds[bracket.currentRound];
  const matchup = round[bracket.currentMatchup];
  if (matchup.winner !== null) return;

  matchup.winner = side;
  save();
  applyVoteUI(side, side === 0 ? matchup.songA : matchup.songB);
}

function applyVoteUI(side, winner) {
  const ca = document.getElementById('card-a');
  const cb = document.getElementById('card-b');
  ca.onclick = null;
  cb.onclick = null;

  if (side === 0) { ca.className = 'song-card picked'; cb.className = 'song-card dropped'; }
  else            { ca.className = 'song-card dropped'; cb.className = 'song-card picked'; }

  const msg = document.getElementById('vote-msg');
  msg.textContent = `âœ“ You picked "${winner[2]}"`;
  msg.className   = 'vote-msg confirmed';
  document.getElementById('next-btn').style.display = 'block';
}

function advanceMatchup() {
  bracket.currentMatchup++;
  const round = bracket.rounds[bracket.currentRound];

  if (bracket.currentMatchup >= round.length) {
    // Round finished
    const winners = round.map(m => m.winner === 0 ? m.songA : m.songB);
    document.getElementById('bar-fill').style.width = '100%';

    // Championship was a 1-matchup round â†’ we now have a champion
    if (winners.length === 1) {
      bracket.champion = winners[0];
      save();
      showChampion(winners[0]);
    } else {
      showRoundComplete(winners);
    }
    return;
  }

  renderMatchup();
}

// â”€â”€ ROUND COMPLETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showRoundComplete(winners) {
  hideAllScreens();
  document.getElementById('round-complete').style.display = 'flex';

  const rName   = ROUND_NAMES[bracket.currentRound] || `Round ${bracket.currentRound + 1}`;
  const nextName = ROUND_NAMES[bracket.currentRound + 1] || 'Championship';

  document.getElementById('rc-head').textContent = `${rName} Complete!`;
  document.getElementById('rc-sub').textContent  = `${winners.length} song${winners.length !== 1 ? 's' : ''} advance to the ${nextName}.`;
  document.getElementById('round-name').textContent = rName;

  // Show advancing songs as chips
  const chips = document.getElementById('rc-advancers');
  chips.innerHTML = '';
  winners.forEach(s => {
    const c = document.createElement('div');
    c.className   = 'rc-song-chip';
    c.textContent = `${s[2]} â€” ${s[3]}`;
    c.title       = c.textContent;
    chips.appendChild(c);
  });
}

function startNextRound() {
  const prevRound = bracket.rounds[bracket.currentRound];
  const winners   = prevRound.map(m => m.winner === 0 ? m.songA : m.songB);

  bracket.currentRound++;
  bracket.currentMatchup = 0;

  // Pair winners: 1 vs 2, 3 vs 4, â€¦
  const newMatchups = [];
  for (let i = 0; i < winners.length; i += 2) {
    newMatchups.push({ songA: winners[i], songB: winners[i+1], seedA: i+1, seedB: i+2, winner: null });
  }
  bracket.rounds.push(newMatchups);
  save();

  document.getElementById('round-complete').style.display = 'none';
  renderMatchup();
}

// â”€â”€ CHAMPION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showChampion(song) {
  hideAllScreens();
  document.getElementById('champion-screen').style.display = 'flex';

  const yr = getDJYear(song[5]);
  document.getElementById('champ-song').textContent   = song[2];
  document.getElementById('champ-artist').textContent = song[3];
  const yrEl = document.getElementById('champ-yr');
  yrEl.textContent = `${yr.label} Â· ${song[5]}`;
  yrEl.style.color = yr.color;

  document.getElementById('round-name').textContent = 'ğŸ† Champion!';
  document.getElementById('bar-fill').style.width   = '100%';
  document.getElementById('mc-nums').textContent    = 'Done';
}

// â”€â”€ BRACKET VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showBracketView() {
  hideAllScreens();
  document.getElementById('bracket-view').style.display = 'flex';
  renderBracketView();
}

function hideBracketView() {
  if (bracket.champion) showChampion(bracket.champion);
  else                  renderMatchup();
}

function renderBracketView() {
  const container = document.getElementById('bv-rounds');
  container.innerHTML = '';

  bracket.rounds.forEach((round, rIdx) => {
    const col   = document.createElement('div');
    col.className = 'bv-col';

    const hd  = document.createElement('div');
    hd.className = 'bv-col-hd';
    hd.textContent = ROUND_NAMES[rIdx] || `Round ${rIdx+1}`;
    col.appendChild(hd);

    const slots = document.createElement('div');
    slots.className = 'bv-slots';

    round.forEach(m => {
      const mu = document.createElement('div');
      mu.className = 'bv-matchup';

      const entryA = makeEntry(m.songA, m.seedA, m.winner === 0 ? 'winner' : m.winner === null ? 'pending' : 'loser');
      const vs     = document.createElement('div');
      vs.className = 'bv-vs'; vs.textContent = 'vs';
      const entryB = makeEntry(m.songB, m.seedB, m.winner === 1 ? 'winner' : m.winner === null ? 'pending' : 'loser');

      mu.appendChild(entryA);
      mu.appendChild(vs);
      mu.appendChild(entryB);
      slots.appendChild(mu);
    });

    col.appendChild(slots);
    container.appendChild(col);
  });

  // Champion column
  if (bracket.champion) {
    const champCol   = document.createElement('div');
    champCol.className = 'bv-col bv-champion-col';
    const champHd    = document.createElement('div');
    champHd.className = 'bv-col-hd'; champHd.textContent = 'ğŸ† Champion';
    const champSlots = document.createElement('div');
    champSlots.className = 'bv-slots';
    const entry      = document.createElement('div');
    entry.className  = 'bv-entry winner';
    entry.innerHTML  = `<span class="bv-seed">ğŸ†</span>${esc(bracket.champion[2])}`;
    entry.title      = `${bracket.champion[2]} â€” ${bracket.champion[3]}`;
    champSlots.appendChild(entry);
    champCol.appendChild(champHd);
    champCol.appendChild(champSlots);
    container.appendChild(champCol);
  }
}

function makeEntry(song, seed, cls) {
  const el = document.createElement('div');
  el.className = `bv-entry ${cls}`;
  el.innerHTML = `<span class="bv-seed">#${seed}</span>${esc(song ? song[2] : 'â€”')}`;
  el.title     = song ? `${song[2]} â€” ${song[3]}` : '';
  return el;
}
</script>
</body>
</html>
